---
title: "pplatt_q"
author: "Poppy Platt"
format: html
---

## Loading my data

This data has now been loaded and cleaned of N/As. For this you will need packages tidyverse and dplyr.

Empty cells are labelled N/A when called into R.

Entries with multiple moods are then duplicated so one cell with multiple moods is transformed into multiple cells with one mood.

Two empty rows are removed.

All data from before 2024 (entries with no mood listed) are removed.

```{r}
library(here)

# Calling my data, and calling any empty cells N/A
sg_initial <- read.csv("pplatt_storygraph.csv", na.strings = c("", "NA"))

library(tidyverse)
library(dplyr)

# Changing cells with multiple moods into multiple rows with one mood
new_sg <- sg_initial %>%
  separate_rows(Moods, sep = ",") %>%
  mutate(Moods = trimws(Moods))

# Removing the two rows of X that simply have NAs
sg_noXrow<-select(new_sg, -X, -X.1) 

# Removing rows that have NA in the Moods column, aka all books read before 2024
sg_clear <- sg_noXrow %>% na.omit()
```

# Visualizing my data

group by mood and rating, count how many are in mood and rating

```{r}
# Creating a new dataset with Moods, Star rating, and how many stars I gave moods.
sg_count <-
  sg_clear %>% 
  group_by(Moods,Star.Rating) %>%
  summarise(count = n())



# Heatmap illustrating the moods of books I read and how many stars I gave books that had these moods, with colour representing how many books I gave that number of stars.
moods_heatmap <- sg_count %>%
  ggplot(mapping = aes(x = Moods, y = Star.Rating, fill = count)) +
  geom_tile() +
  scale_fill_viridis_c(option = "rocket") + #colour package
  labs(title = "Heatmap of Moods by Star rating",
       subtitle = "Moods coloured by frequency of rating",
       x = "Moods", y = "Star rating", fill = "Frequency") +
  theme(axis.text.y = element_text(size = 6)) +
          coord_flip()

moods_heatmap
```
